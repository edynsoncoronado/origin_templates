<p id="135532af-ce56-433a-ad51-98d26f92065c" class=""><strong>Mutex</strong></p><p id="34b1ec7c-3826-4d11-a1d8-4ad061aea4e4" class="">Mutex as the name hints implies <strong>mutual exclusion</strong>. A mutex is used to guard shared data such as a linked-list, an array, or any primitive type.</p><p id="a26f2a6a-cf8c-42be-a846-d7b4902cb7d7" class="">A mutex allows only a single thread to access a resource or critical section.</p><p id="9fde89e4-bac0-4665-b0b5-1d643d4df49f" class="">
</p><p id="093f1b37-eeec-47eb-a756-4dbf79146699" class="">Once a thread acquires a mutex, all other threads attempting to acquire the same mutex are blocked until the first thread releases the mutex. Once released, most implementations arbitrarily choose one of the waiting threads to acquire the mutex and make progress.</p><p id="9ce45185-c065-4359-90e3-48210448d5e8" class="">
</p><p id="65eab36b-f13e-4d5f-9500-7843302ca8d4" class=""><strong>Semaphore</strong></p><p id="4abece8d-1738-402b-9ef8-a39d70d6f7ee" class="">Semaphore, on the other hand, is used for limiting access to a collection of resources.</p><p id="1081a4ca-7634-4f66-9d70-c44dca602b5f" class="">
</p><p id="525d0f08-d8f1-4691-9b86-c8d0d55bb5a7" class="">A typical example would be a pool of database connections that can be handed out to requesting threads. Say there are ten available connections but 50 requesting threads. In such a scenario, a semaphore can only give out ten permits or connections at any given point.</p><p id="03021aeb-7766-4b30-80ce-81b0b8922f6b" class="">
</p><p id="0888bfe3-bb87-467c-bc23-75e6c0f725cb" class="">A semaphore with a single permit is called a binary semaphore and is often thought of as equivalent to a mutex, which isn&#x27;t completely correct.</p><p id="f7b36ff1-cef6-4828-b2f7-65be8b4e88c2" class="">Semaphores can also be used for signaling among threads.</p><p id="c9a55b96-8536-43ba-bb1b-75142006481e" class="">This is an important distinction as it allows threads to cooperatively work towards completing a task.</p><p id="0f4afdb4-5072-4dac-879d-f6c3dcc66be4" class="">A mutex, on the other hand, is strictly limited to serializing access to shared state among competing threads.</p><p id="47e46c9b-edc7-4e86-9ffc-4dbc73269858" class="">
</p><p id="769a1427-0050-47e0-83d9-e430fd11057a" class=""><strong>Mutex Example</strong></p><p id="6d00e683-9a84-431f-86f1-cd5e8b717040" class="">The following illustration shows how two threads acquire and release a mutex one after the other to gain access to shared data. Mutex guarantees that the shared state isn&#x27;t corrupted when competing threads work on it.</p>
<div class="text-center">
    <img src="assets_env_image/4.png" class="rounded" alt="..." style="width: 80%;">
</div>
<p id="5fd6e53f-360e-4193-9bd3-8387154f5184" class="">
</p><p id="5acf2d0b-1e18-4f1b-ae34-ba2137ede899" class=""><strong>When can a Semaphore masquerade as a Mutex?</strong></p><p id="0b2599b6-b1ce-4221-897e-5efac0da49a4" class="">A semaphore can potentially act as a mutex if the permits it can give out is set to 1.</p><p id="78e06dd9-3677-48c6-bc6d-eae17a4ff536" class="">However, the most important difference between the two is that in case of a mutex <strong>the same thread must call acquire and subsequent release on the mutex</strong> whereas in case of a binary semaphore, <strong>different threads can call acquire and release on the semaphore</strong>.</p><p id="c78d9765-8c94-40d9-bae8-09261392283f" class="">This leads us to the concept of <strong>ownership</strong>. <strong>A mutex is owned by the thread acquiring it till the point the owning-thread releases it, whereas for a semaphore there&#x27;s no notion of ownership.</strong></p><p id="d1c5bd01-9252-4f46-9e54-2b1a0c7df6ce" class="">
</p><p id="b7c8097d-771a-40f9-841d-837dd3aae1a0" class=""><strong>Semaphore for Signaling</strong></p><p id="da02587b-41c5-40f1-9191-42dd0a857634" class="">Another distinction between a semaphore and a mutex is that semaphores can be used for signaling amongst threads.</p><p id="0c75de2c-1917-4e91-94fb-0bc7afa8ae50" class="">For example, in case of the classical <strong>producer/consumer</strong> problem the producer thread can signal the consumer thread by incrementing the semaphore count to indicate to the consumer thread to consume the freshly produced item.</p><p id="e11d14b1-a7e6-45ef-ba70-5d8c7601c063" class="">A mutex, in contrast, only guards access to shared data among competing threads by forcing threads to serialize their access to critical sections and shared data-structures.</p><p id="be8bf7c7-a49e-43cc-8bfa-121b89941dd9" class="">Below is a pictorial representation of how a mutex works.</p>
<div class="text-center">
    <img src="assets_env_image/5.png" class="rounded" alt="..." style="width: 80%;">
</div>
<p id="622851f7-bf91-4517-a70d-29fcfdee4c3c" class="">Below is a depiction of how a semaphore works. The semaphore initially has two permits and allows at most two threads to enter the critical section or access protected resources</p>
<div class="text-center">
    <img src="assets_env_image/6.png" class="rounded" alt="..." style="width: 80%;">
</div>
<p id="118733ce-523f-4169-ae49-10849e4eb1bd" class="">
</p><p id="c06bb6ff-a729-441e-8c23-e80f962c3dfe" class=""><strong>Summary</strong></p><ul id="0fa49e61-c7e0-4702-b9ca-ccfc5acfe59c" class="bulleted-list"><li>Mutex implies mutual exclusion and is used to serialize access to critical sections whereas semaphore can potentially be used as a mutex, but it can also be used for cooperation and signaling amongst threads.
Semaphore also solves the issue of <strong>missed signals</strong>.</li></ul><ul id="c19a9d1d-a649-4f1b-8746-90fca4c459b6" class="bulleted-list"><li>Mutex is <strong>owned</strong> by a thread, whereas a semaphore has no concept of ownership.</li></ul><ul id="39280d8d-bc51-431a-a490-da826f3fa47c" class="bulleted-list"><li>Mutex, if locked, must necessarily be unlocked by the same
thread. A semaphore can be acted upon by different threads. This is true even if the semaphore has a permit of one</li></ul><p id="3a288458-a564-497c-9b76-bd0fc06108fb" class="">
</p>
<br>
<p id="fd5db921-ecd2-4b81-9a9b-53a8294e3dd5" class="">Think of semaphore as analogous to a car rental service such as Hertz.</p><p id="a5676d05-d40e-47b0-8090-e32ed212c46b" class="">Each outlet has a certain number of cars it can rent out to customers.</p><p id="24fd887c-0e5b-4cee-8150-9f9220c2828e" class="">It can rent several cars to several customers at the same time but if all the cars are rented out, then any new customers need to be put on a waitlist till one of the rented cars is returned.</p><p id="3175b3a5-293e-4d03-8a5a-7fdf8bba5553" class="">In contrast, think of a mutex like a lone runway on a remote airport.</p><p id="bd3e2163-fd90-49ae-b4fc-6fae239837c6" class="">Only a single jet can land or take-off from the runway at any given point.</p><p id="d73c655c-3b8d-4c94-a218-a1e3cab13642" class="">No other jet can use the runway simultaneously with the first aircraft.</p><p id="8a688671-63d9-43b3-ba95-9f8423fd38a7" class="">
</p>